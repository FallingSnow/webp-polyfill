function testWebP(a){var b=new Image;b.src="data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA";b.onload=b.onerror=function(){a(2===b.height)}}
var webpPolyfill={_convertBinaryToArray:function(a){var b=[],d=a.length,e;for(e=0;e<d;++e)b.push(a.charCodeAt(e));return b},_WebPDecodeAndDraw:function(a,b){var d=new WebPDecoder;b=b.split("").map(function(a){return String.fromCharCode(a.charCodeAt(0)&255)}).join("");b=webpPolyfill._convertBinaryToArray(b);var e=d.WebPDecoderConfig,c=e.j,m=e.input;if(!d.WebPInitDecoderConfig(e))return console.error("Library version mismatch!"),-1;status=d.WebPGetFeatures(b,b.length,m);0!=status&&console.error("Unable to decode webp image.");
c.J=4;status=d.WebPDecode(b,b.length,e);if(0!=status)return console.error("Decoding failed."),-1;var h=c.c.RGBA.ma;if(h){d=c.height;c=c.width;a.attr("height",d).attr("width",c);a=a[0];e=a.width;m=a.height;a.width=c;a.height=d;for(var k=a.getContext("2d"),l=k.createImageData(a.width,a.height),n=l.data,f=0;f<d;f++)for(var g=0;g<c;g++)n[0+4*g+4*c*f]=h[1+4*g+4*c*f],n[1+4*g+4*c*f]=h[2+4*g+4*c*f],n[2+4*g+4*c*f]=h[3+4*g+4*c*f],n[3+4*g+4*c*f]=h[0+4*g+4*c*f];k.putImageData(l,0,0);k.drawImage(a,0,0);h=k.getImageData(0,
0,a.width,a.height);l=jQuery("<canvas>").attr("width",h.width).attr("height",h.height)[0];l.getContext("2d").putImageData(h,0,0);a.width=e;a.height=m;k.scale(e/c,m/d);k.drawImage(l,0,0);return a.toDataURL()}},_process:function(a,b){a=jQuery(a);var d=a.attr("src");if("webp"===d.split(".").pop()){var e=jQuery('<canvas style="display: none;"></canvas>');jQuery.ajax(d,{processData:!1,mimeType:"text/plain; charset=x-user-defined"}).done(function(b){a.attr("src",webpPolyfill._WebPDecodeAndDraw(e,b))});
b||(jQuery(a).off("DOMAttrModified.webp"),jQuery(a).on("DOMAttrModified.webp",function(){var b=a.attr("src");if("webp"===b.split(".").pop()){var d=jQuery('<canvas style="display: none;"></canvas>');jQuery.ajax(b,{processData:!1,mimeType:"text/plain; charset=x-user-defined"}).done(function(b){a.attr("src",webpPolyfill._WebPDecodeAndDraw(d,b))})}}))}},_webpNotSupported:function(a){null===webpPolyfill._nativeSupport?setTimeout(function(){webpPolyfill._webpNotSupported(a)},100):!1===webpPolyfill._nativeSupport&&
a()},evaluateParent:function(a,b){webpPolyfill._webpNotSupported(function(){jQuery(a).find("img").each(function(a,e){webpPolyfill._process(e,b)})})},evaluate:function(a,b){webpPolyfill._webpNotSupported(function(){webpPolyfill._nativeSupport||webpPolyfill._process(a,b)})},detach:function(a){a=jQuery(a);jQuery(a).off("DOMAttrModified.webp")},getDataUriOfWebpImage:function(a){a=jQuery(a);a=a.attr("src");if("webp"!==a.split(".").pop())return!1;var b=jQuery('<canvas style="display: none;"></canvas>');
jQuery.ajax(a,{processData:!1,mimeType:"text/plain; charset=x-user-defined"}).done(function(a){return webpPolyfill._WebPDecodeAndDraw(b,a)})},getDataUriOfWebpUrl:function(a){var b=jQuery('<canvas style="display: none;"></canvas>');jQuery.ajax(a,{processData:!1,mimeType:"text/plain; charset=x-user-defined"}).done(function(a){return webpPolyfill._WebPDecodeAndDraw(b,a)})},_nativeSupport:null};testWebP(function(a){webpPolyfill._nativeSupport=a?!0:!1});